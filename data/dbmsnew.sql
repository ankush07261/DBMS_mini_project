create database STUDENT_CLUBS;

create table STUDENT_CLUBS.CLUB (
	CLUB_ID VARCHAR(10) PRIMARY KEY, 
	CLUB_NAME VARCHAR(30),
	NO_OF_MEMBERS INT
);

insert into STUDENT_CLUBS.CLUB values
('JIT2021CS', 'TECHNOCLUB', 48);
insert into STUDENT_CLUBS.CLUB values
('JIT2023EC', 'IoTECH', 84);
insert into STUDENT_CLUBS.CLUB values
('JIT2024CS', 'IEEE', 14);

select * from STUDENT_CLUBS.CLUB;


CREATE TABLE STUDENT_CLUBS.ACCOUNTS (
    ACCOUNT_NO INT(10) PRIMARY KEY,
    AVAILABLE_BALANCE INT,
    CLUB_ID VARCHAR(10),
    FOREIGN KEY (CLUB_ID) REFERENCES STUDENT_CLUBS.CLUB(CLUB_ID) ON DELETE CASCADE
);

insert into STUDENT_CLUBS.ACCOUNTS values
( 861087600, 2000, 'JIT2021CS');
insert into STUDENT_CLUBS.ACCOUNTS values
( 759787600, 3080, 'JIT2023EC');
insert into STUDENT_CLUBS.ACCOUNTS values
( 991087610, 5000, 'JIT2024CS');

select * from STUDENT_CLUBS.ACCOUNTS;


CREATE TABLE STUDENT_CLUBS.CLUB_EVENTS (
	EVENT_ID INT PRIMARY KEY, 
    EVENT_NAME VARCHAR(35),
    CLUB_ID VARCHAR(10),
    EVENT_DATE DATE,
    EVENT_TIME TIME,
    PLACE VARCHAR(25),
    DESCRIPTIONS VARCHAR(300),
    PARTICIPATION_COUNT INT,
    FOREIGN KEY (CLUB_ID) REFERENCES STUDENT_CLUBS.CLUB(CLUB_ID) ON DELETE CASCADE
    );
    
insert into STUDENT_CLUBS.CLUB_EVENTS values
( 202412, 'IDEATHON', 'JIT2021CS', '2024-03-14', '09:30', 'JIT QUADRANGLE', 'Ideate creative solutions to specific problems', 180);
insert into STUDENT_CLUBS.CLUB_EVENTS values
( 202202, 'HACKATHON', 'JIT2021CS', '2022-12-19', '11:30', 'CONVENTION HALL', 'Develop SOFTWARE solutions to specific problems', 180);
insert into STUDENT_CLUBS.CLUB_EVENTS values
( 202308, 'IoTHON', 'JIT2023EC', '2023-08-29', '13:30', 'JIT QUADRANGLE', 'Unleashing IoT innovations in a compact event', 20);
insert into STUDENT_CLUBS.CLUB_EVENTS values
( 202403, 'MINI CRICKET', 'JIT2024CS', '2023-12-19', '14:00', 'JIT GROUNDS', 'Small pitches, big moments', 20);

select * from STUDENT_CLUBS.CLUB_EVENTS;


CREATE TABLE STUDENT_CLUBS.MEMBERS (
	EVENT_ID INT PRIMARY KEY, 
    FNAME VARCHAR(35),
    LNAME VARCHAR(30),
    EMAIL VARCHAR(150),
    MEMBER_PHONE INT,
    SEMESTER INT
    );
    
ALTER TABLE STUDENT_CLUBS.MEMBERS
CHANGE COLUMN MEMBER_ID MEMBER_ID varchar(10);

insert into STUDENT_CLUBS.MEMBERS values
( '1JT21CS098', 'JOHN', 'SMITH', 'johnsmith@gmail.com', 973847563, 3);
insert into STUDENT_CLUBS.MEMBERS values
( '1JT21EC055', 'SHRAVYA', 'L', 'shravyal19@gmail.com', 973973633, 5);
insert into STUDENT_CLUBS.MEMBERS values
( '1JT23CS022', 'ANKUSH', 'G', 'ankushg@yahoo.com', 829363543, 1);
insert into STUDENT_CLUBS.MEMBERS values
( '1JT20EC130', 'RAM', 'SINGH', 'Ramsingh1001@yahoo.com', 993037563, 7);
insert into STUDENT_CLUBS.MEMBERS values
( '1JT20CS403', 'AKASH', 'HS', 'hsakash877@gmail.com', 273899763, 7);
insert into STUDENT_CLUBS.MEMBERS values
( '1JT21CS122', 'SHREYA', 'KASHYAP', 'kshreya1908@yahoo.com', 823764363, 5);
insert into STUDENT_CLUBS.MEMBERS values
( '1JT23EC116', 'THRUPTHI', 'V', 'thrupthi123@gmail.com', 836454763, 1);
insert into STUDENT_CLUBS.MEMBERS values
( '1JT22EC089', 'SAMHITHA', 'R', 'samravi2711@gmail.com', 986752763, 3);

select * from STUDENT_CLUBS.MEMBERS;


CREATE TABLE STUDENT_CLUBS.CLUB_HEADS (
	MEMBER_ID varchar(10),
    CLUB_ID VARCHAR(10), 
    FNAME VARCHAR(35),
    LNAME VARCHAR(30),
    EMAIL VARCHAR(150),
    MEMBER_PHONE INT,
    SEMESTER INT,
    DESIGNATION VARCHAR(100),
    primary key(MEMBER_ID, CLUB_ID),
    foreign key (MEMBER_ID) references STUDENT_CLUBS.MEMBERS(MEMBER_ID) on delete cascade,
    FOREIGN KEY (CLUB_ID) REFERENCES STUDENT_CLUBS.CLUB(CLUB_ID) ON DELETE CASCADE
    );
    
insert into STUDENT_CLUBS.CLUB_HEADS values
('1JT21CS098', 'JIT2021CS', 'JOHN', 'SMITH', 'johnsmith@gmail.com', 973847563, 3, 'Tech Explorer');
insert into STUDENT_CLUBS.CLUB_HEADS values
('1JT21EC055', 'JIT2024CS', 'SHRAVYA', 'L', 'shravyal19@gmail.com', 973973633, 5, 'Signal Processing Maestro');
insert into STUDENT_CLUBS.CLUB_HEADS values
('1JT23CS022', 'JIT2021CS','ANKUSH', 'G', 'ankushg@yahoo.com', 829363543, 1, 'UI/UX Maven');
insert into STUDENT_CLUBS.CLUB_HEADS values
( '1JT20EC130', 'JIT2023EC','RAM', 'SINGH', 'Ramsingh1001@yahoo.com', 993037563, 7, 'IoT Architect');
insert into STUDENT_CLUBS.CLUB_HEADS values
( '1JT20CS403', 'JIT2024CS','AKASH', 'HS', 'hsakash877@gmail.com', 273899763, 7, 'Electrical Innovator');
insert into STUDENT_CLUBS.CLUB_HEADS values
( '1JT21CS122', 'JIT2021CS','SHREYA', 'KASHYAP', 'kshreya1908@yahoo.com', 823764363, 5, 'Cyber Sentinel');
insert into STUDENT_CLUBS.CLUB_HEADS values
( '1JT23EC116', 'JIT2023EC', 'THRUPTHI', 'V', 'thrupthi123@gmail.com', 836454763, 1, 'Data Fusion Specialist');
insert into STUDENT_CLUBS.CLUB_HEADS values
( '1JT22EC089', 'JIT2024CS','SAMHITHA', 'R', 'samravi2711@gmail.com', 986752763, 3, 'Robotics Trailblazer');

select * from STUDENT_CLUBS.CLUB_HEADS;


CREATE TABLE STUDENT_CLUBS.LOGIN (
    LOGIN_ID VARCHAR(10) PRIMARY KEY,
    USERNAME VARCHAR(50),
    USER_PASSWORD VARCHAR(255)
);

insert into STUDENT_CLUBS.LOGIN values
('1JT21CS098', 'TECHNOCLUBLOG', 'TECHNOCLUB21CS');
insert into STUDENT_CLUBS.LOGIN values
('1JT21EC055', 'IEEELOG', 'IEEE24CS');
insert into STUDENT_CLUBS.LOGIN values
('1JT23CS022', 'TECHNOCLUBLOG', 'TECHNOCLUB21CS');
insert into STUDENT_CLUBS.LOGIN values
('1JT20EC130', 'IoTECHLOG', 'IoTTECHCLUB23EC');
insert into STUDENT_CLUBS.LOGIN values
('1JT20CS403', 'IEEELOG', 'IEEE24CS');
insert into STUDENT_CLUBS.LOGIN values
( '1JT21CS122', 'TECHNOCLUBLOG', 'TECHNOCLUB21CS');
insert into STUDENT_CLUBS.LOGIN values
( '1JT23EC116', 'IoTECHLOG', 'IoTTECHCLUB23EC');
insert into STUDENT_CLUBS.LOGIN values
( '1JT22EC089','IEEELOG', 'IEEE24CS');

select * from STUDENT_CLUBS.LOGIN;


CREATE TABLE STUDENT_CLUBS.LOGISTICS (
	EVENT_ID INT PRIMARY KEY,
    FUNDS_AVAILABLE INT,
    FOREIGN KEY (EVENT_ID) REFERENCES STUDENT_CLUBS.CLUB_EVENTS(EVENT_ID) ON DELETE CASCADE
);

insert into STUDENT_CLUBS.LOGISTICS values
(202412, 1000);
insert into STUDENT_CLUBS.LOGISTICS values
(202202, 1000);
insert into STUDENT_CLUBS.LOGISTICS values
(202308, 2000);
insert into STUDENT_CLUBS.LOGISTICS values
(202403, 3000);

select * from STUDENT_CLUBS.LOGISTICS;


CREATE TABLE STUDENT_CLUBS.MEMBER_CLUBS(
	MEMBER_ID varchar(10),
    CLUB_ID VARCHAR(10),
    primary key(MEMBER_ID, CLUB_ID),
    foreign key (MEMBER_ID) references STUDENT_CLUBS.MEMBERS(MEMBER_ID) on delete cascade,
    FOREIGN KEY (CLUB_ID) REFERENCES STUDENT_CLUBS.CLUB(CLUB_ID) ON DELETE CASCADE
    );
    
insert into STUDENT_CLUBS.MEMBER_CLUBS values
('1JT21EC055', 'JIT2023EC');
insert into STUDENT_CLUBS.MEMBER_CLUBS values
('1JT21CS122', 'JIT2024CS');
insert into STUDENT_CLUBS.MEMBER_CLUBS values
('1JT22EC089', 'JIT2023EC');

select * from STUDENT_CLUBS.MEMBER_CLUBS;

DELIMITER //

CREATE PROCEDURE AddNewMember(
    IN member_id VARCHAR(10),
    IN fname VARCHAR(35),
    IN lname VARCHAR(30),
    IN email VARCHAR(150),
    IN member_phone INT,
    IN semester INT
)
BEGIN
    -- Check if the member already exists
    IF NOT EXISTS (SELECT 1 FROM STUDENT_CLUBS.MEMBERS WHERE MEMBER_ID = member_id) THEN
        -- Member does not exist, insert a new record
        INSERT INTO STUDENT_CLUBS.MEMBERS (MEMBER_ID, FNAME, LNAME, EMAIL, MEMBER_PHONE, SEMESTER)
        VALUES (member_id, fname, lname, email, member_phone, semester);
    END IF;
END //

DELIMITER ;
